<!DOCTYPE html>
<html lang="mk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Makedon World News | –ñ–∏–≤–∏ –í–µ—Å—Ç–∏</title>
    <style>
        :root { --primary: #d32f2f; --dark: #1a1a1a; --light: #f4f4f4; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background: var(--light); color: #333; }
        header { background: var(--dark); color: white; text-align: center; padding: 2rem 1rem; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .container { max-width: 1000px; margin: 20px auto; padding: 0 15px; }
        .controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; background: white; padding: 15px; border-radius: 8px; }
        #news-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .news-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: 0.3s; display: flex; flex-direction: column; }
        .news-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0,0,0,0.2); }
        .news-card img { width: 100%; height: 180px; object-fit: cover; background: #eee; }
        .news-content { padding: 15px; flex-grow: 1; }
        .news-source { font-size: 0.75rem; text-transform: uppercase; color: var(--primary); font-weight: bold; }
        .news-title { font-size: 1.1rem; margin: 10px 0; font-weight: bold; line-height: 1.4; color: var(--dark); }
        .news-desc { font-size: 0.9rem; color: #666; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        .btn-read { display: inline-block; margin-top: 15px; padding: 8px 15px; background: var(--primary); color: white; text-decoration: none; border-radius: 5px; font-size: 0.85rem; }
        footer { background: var(--dark); color: white; text-align: center; padding: 30px; margin-top: 50px; }
        .loading { text-align: center; grid-column: 1/-1; padding: 50px; font-weight: bold; }
    </style>
</head>
<body>

<header>
    <h1>üåç Makedon World News</h1>
    <p>–ù–∞—ò–Ω–æ–≤–∏—Ç–µ –≤–µ—Å—Ç–∏ –æ–¥ –ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞ –∏ —Å–≤–µ—Ç–æ—Ç, –≤–æ —Ä–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ.</p>
</header>

<div class="container">
    <div class="controls">
        <div id="status">üì° –°–µ –≤—á–∏—Ç—É–≤–∞–∞—Ç –∏–∑–≤–æ—Ä–∏...</div>
        <button onclick="fetchDirectNews()" style="cursor:pointer; padding: 8px 15px; border: none; background: #333; color: white; border-radius: 5px;">‚Üª –û—Å–≤–µ–∂–∏</button>
    </div>

    <div id="news-grid">
        <div class="loading">–í–µ –º–æ–ª–∏–º–µ –ø–æ—á–µ–∫–∞—ò—Ç–µ, –≥–∏ —Å–æ–±–∏—Ä–∞–º–µ –Ω–∞—ò–Ω–æ–≤–∏—Ç–µ –≤–µ—Å—Ç–∏...</div>
    </div>
</div>

<footer>
    <p>¬© 2026 Makedon World News | –°–∏—Ç–µ –ø—Ä–∞–≤–∞ —Å–µ –∑–∞–¥—Ä–∂–∞–Ω–∏</p>
</footer>

<script>
// –¢–í–û–à–û–¢ –°–ü–ò–°–û–ö –ù–ê RSS –ò–ó–í–û–†–ò
const RSS_SOURCES = [
    { name: "Sitel", url: "https://sitel.com.mk/rss.xml" },
    { name: "Kanal 5", url: "https://kanal5.com.mk/rss" },
    { name: "A1On", url: "https://a1on.mk/feed/" },
    { name: "Telma", url: "https://telma.com.mk/feed/" }
];

// Proxy —Å–µ—Ä–≤–µ—Ä –∑–∞ –¥–∞ –Ω–µ –Ω√® –±–ª–æ–∫–∏—Ä–∞–∞—Ç
const PROXY = "https://api.allorigins.win/raw?url=";

async function fetchDirectNews() {
    const grid = document.getElementById('news-grid');
    const status = document.getElementById('status');
    grid.innerHTML = '<div class="loading">–ü—Ä–æ–≤–µ—Ä—É–≤–∞–º–µ –∑–∞ –Ω–æ–≤–∏ –≤–µ—Å—Ç–∏...</div>';
    
    let allPosts = [];

    for (let src of RSS_SOURCES) {
        try {
            const response = await fetch(PROXY + encodeURIComponent(src.url));
            const text = await response.text();
            const xml = new DOMParser().parseFromString(text, "text/xml");
            const items = xml.querySelectorAll("item");

            items.forEach(el => {
                let img = "https://via.placeholder.com/400x250?text=MWN+News";
                
                // –ù–∞–æ—ì–∞—ö–µ –Ω–∞ —Å–ª–∏–∫–∞ (RSS –∑–Ω–∞–µ –¥–∞ –±–∏–¥–µ –∫–æ–º–ø–ª–∏—Ü–∏—Ä–∞–Ω)
                const enclosure = el.querySelector("enclosure");
                const mediaContent = el.getElementsByTagName("media:content")[0];
                if (enclosure) img = enclosure.getAttribute("url");
                else if (mediaContent) img = mediaContent.getAttribute("url");
                else {
                    const descText = el.querySelector("description")?.textContent || "";
                    const match = descText.match(/<img[^>]+src="([^">]+)"/);
                    if (match) img = match[1];
                }

                allPosts.push({
                    source: src.name,
                    title: el.querySelector("title")?.textContent || "",
                    link: el.querySelector("link")?.textContent || "#",
                    desc: el.querySelector("description")?.textContent.replace(/<\/?[^>]+(>|$)/g, "").substring(0, 120) + "...",
                    date: new Date(el.querySelector("pubDate")?.textContent || Date.now())
                });
            });
        } catch (err) {
            console.error("–ì—Ä–µ—à–∫–∞ —Å–æ " + src.name);
        }
    }

    // –°–æ—Ä—Ç–∏—Ä–∞—ò –ø–æ –¥–∞—Ç—É–º (–Ω–∞—ò–Ω–æ–≤–∏ –ø—Ä–≤–∏)
    allPosts.sort((a, b) => b.date - a.date);

    grid.innerHTML = "";
    allPosts.forEach(post => {
        grid.innerHTML += `
            <div class="news-card">
                <div class="news-content">
                    <span class="news-source">${post.source} ‚Ä¢ ${post.date.toLocaleTimeString('mk-MK')}</span>
                    <div class="news-title">${post.title}</div>
                    <p class="news-desc">${post.desc}</p>
                    <a href="${post.link}" target="_blank" class="btn-read">–ü—Ä–æ—á–∏—Ç–∞—ò –ø–æ–≤–µ—ú–µ</a>
                </div>
            </div>
        `;
    });
    status.textContent = `‚úÖ –í—á–∏—Ç–∞–Ω–∏ ${allPosts.length} –≤–µ—Å—Ç–∏`;
}

// –°—Ç–∞—Ä—Ç—É–≤–∞—ò –≤–µ–¥–Ω–∞—à
fetchDirectNews();
</script>

</body>
</html>
