<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Makedon World News</title>

  <style>
    :root{
      --bg:#f5f5f5;
      --card:#ffffff;
      --text:#222;
      --muted:#666;
      --black:#111;
      --line:rgba(255,255,255,0.35);
      --shadow:0 1px 0 rgba(0,0,0,0.04);
      --radius:12px;
      --max:900px;
    }

    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Ubuntu,sans-serif;
      line-height:1.6;
      background:var(--bg);
      color:var(--text);
    }

    header{
      background:var(--black);
      color:#fff;
      text-align:center;
      padding:22px 16px 16px;
    }

    header img{
      max-width:220px;
      width:100%;
      height:auto;
      border-radius:12px;
    }

    .site-title{
      font-size:2.7em;
      font-weight:800;
      margin:12px 0 6px;
      letter-spacing:0.2px;
    }

    .site-tagline{
      font-size:1.05em;
      color:#ddd;
      margin:0;
    }

    .header-sep{
      border:0;
      height:1px;
      background:var(--line);
      width:100%;
      margin:12px 0 14px;
    }

    .container{
      max-width:var(--max);
      margin:0 auto;
      padding:0 16px;
    }

    section{
      background:var(--card);
      border-radius:var(--radius);
      padding:22px;
      margin:18px auto;
      box-shadow:var(--shadow);
    }

    .trust{
      background:var(--black);
      color:#fff;
    }
    .trust hr{ opacity:0.25; }

    h2{ margin:0 0 12px; }
    h3{ margin:18px 0 10px; }

    a{ color:#0b5ed7; text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .rss-toolbar{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom:10px;
    }

    .badge{
      display:inline-block;
      font-size:0.85em;
      padding:4px 10px;
      border-radius:999px;
      background:#eee;
      color:#333;
    }

    .btn{
      cursor:pointer;
      border:1px solid #ddd;
      background:#fff;
      padding:8px 12px;
      border-radius:10px;
      font-weight:600;
    }
    .btn:hover{ background:#f2f2f2; }

    .rss-item{
      margin:10px 0 14px;
      padding-bottom:10px;
      border-bottom:1px solid #eee;
    }
    .rss-item:last-child{ border-bottom:0; padding-bottom:0; }
    .rss-item strong{ display:inline-block; margin-bottom:2px; }

    footer{
      background:var(--black);
      color:#eee;
      padding:32px 16px;
      margin-top:40px;
      text-align:center;
      font-size:0.95em;
    }

    .footer-links a{
      color:#eee;
      text-decoration:none;
      margin:0 10px;
      display:inline-block;
      padding:6px 0;
    }
    .footer-links a:hover{ text-decoration:underline; }

    .footer-divider{
      height:1px;
      background:#2a2a2a;
      margin:18px auto;
      max-width:520px;
    }

    @media (max-width:600px){
      .site-title{ font-size:2.15em; }
      header img{ max-width:180px; }
    }
  </style>
</head>

<body>
  <header>
    <img src="hero.jpg" alt="Makedon World News ‚Äì –Ω–µ–∑–∞–≤–∏—Å–µ–Ω –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Å—Ç–∏" />
    <div class="site-title">üåç Makedon World News</div>
    <hr class="header-sep">
    <p class="site-tagline">–ù–µ–∑–∞–≤–∏—Å–µ–Ω –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Å—Ç–∏ –æ–¥ –ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞, –ë–∞–ª–∫–∞–Ω–æ—Ç, –ï–≤—Ä–æ–ø–∞ –∏ —Å–≤–µ—Ç–æ—Ç.</p>
  </header>

  <div class="container">

    <section id="about">
      <h2>üõ°Ô∏è About / Mission</h2>

      <p><strong>Makedon World News</strong> –µ –Ω–µ–∑–∞–≤–∏—Å–µ–Ω –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Å—Ç–∏ –æ–¥ –†–µ–ø—É–±–ª–∏–∫–∞ –°–µ–≤–µ—Ä–Ω–∞ –ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞,
      –ë–∞–ª–∫–∞–Ω–æ—Ç, –ï–≤—Ä–æ–ø–∞ –∏ —Å–≤–µ—Ç–æ—Ç.</p>

      <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ç–∞ —Å–æ–±–∏—Ä–∞, —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∏—Ä–∞ –∏ –ø—Ä–∏–∫–∞–∂—É–≤–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–¥ –¥–æ–≤–µ—Ä–ª–∏–≤–∏ –º–µ–¥–∏—É–º—Å–∫–∏ –∏–∑–≤–æ—Ä–∏,
      —Å–æ —Ü–µ–ª –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏—Ç–µ –¥–∞ –¥–æ–±–∏—ò–∞—Ç –±—Ä–∑, —ò–∞—Å–µ–Ω –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω –ø—Ä–µ–≥–ª–µ–¥ –Ω–∞ –∞–∫—Ç—É–µ–ª–Ω–∏—Ç–µ –Ω–∞—Å—Ç–∞–Ω–∏.</p>

      <p>Makedon World News –Ω–µ —Å–æ–∑–¥–∞–≤–∞ —Å–æ–ø—Å—Ç–≤–µ–Ω–∏ –≤–µ—Å—Ç–∏ –∏ –Ω–µ –ø—Ä–æ–º–æ–≤–∏—Ä–∞ –ø–æ–ª–∏—Ç–∏—á–∫–∏, –Ω–∞—Ü–∏–æ–Ω–∞–ª–Ω–∏ –∏–ª–∏ –∏–¥–µ–æ–ª–æ—à–∫–∏ –∞–≥–µ–Ω–¥–∏.</p>

      <h3>üéØ –ù–∞—à–∞—Ç–∞ –º–∏—Å–∏—ò–∞</h3>
      <ul>
        <li>–°–ª–æ–±–æ–¥–µ–Ω –∏ –æ—Ç–≤–æ—Ä–µ–Ω –ø—Ä–∏—Å—Ç–∞–ø –¥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</li>
        <li>–ü–æ—Ç—Ç–∏–∫–Ω—É–≤–∞—ö–µ –Ω–∞ –º–µ–¥–∏—É–º—Å–∫–∞ –ø–∏—Å–º–µ–Ω–æ—Å—Ç</li>
        <li>–ü–æ–¥–æ–±—Ä–æ —Ä–∞–∑–±–∏—Ä–∞—ö–µ –Ω–∞ –Ω–∞—Å—Ç–∞–Ω–∏—Ç–µ –ø—Ä–µ–∫—É –ø–æ–≤–µ—ú–µ –∏–∑–≤–æ—Ä–∏</li>
        <li>–ù–∞–º–∞–ª—É–≤–∞—ö–µ –Ω–∞ –≤–ª–∏—ò–∞–Ω–∏–µ—Ç–æ –Ω–∞ –¥–µ–∑–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</li>
      </ul>

      <h3>üåç English Version</h3>
      <p><strong>Makedon World News</strong> is an independent news aggregator based in the Republic of North Macedonia,
      covering the Balkans, Europe, and the world.</p>
      <p>We aggregate and link to original sources so users can compare coverage and form informed opinions.</p>
    </section>

    <section id="trust" class="trust">
      <h2>üîê –î–æ–≤–µ—Ä–±–∞ &amp; –¢—Ä–∞–Ω—Å–ø–∞—Ä–µ–Ω—Ç–Ω–æ—Å—Ç</h2>
      <p><strong>Makedon World News</strong> –Ω–µ –∫—Ä–µ–∏—Ä–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∞ –Ω–æ–≤–∏–Ω–∞—Ä—Å–∫–∞ —Å–æ–¥—Ä–∂–∏–Ω–∞ ‚Äì –∞–≥—Ä–µ–≥–∏—Ä–∞ –∏ —É–ø–∞—Ç—É–≤–∞ –∫–æ–Ω –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –∏–∑–≤–æ—Ä–∏,
      —Å–æ —ò–∞—Å–Ω–æ –Ω–∞–≤–µ–¥—É–≤–∞—ö–µ –Ω–∞ –∏–∑–≤–æ—Ä–æ—Ç –∑–∞ —Å–µ–∫–æ—ò–∞ –≤–µ—Å—Ç.</p>
      <p>–¶–µ–ª—Ç–∞ –µ —Ç—Ä–∞–Ω—Å–ø–∞—Ä–µ–Ω—Ç–Ω–æ –∏ –Ω–µ–ø—Ä–∏—Å—Ç—Ä–∞—Å–Ω–æ –¥–∞ –ø—Ä–∏–∫–∞–∂–µ–º–µ –ø–æ–≤–µ—ú–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏ –∏–∑–≤–æ—Ä–∏ –∑–∞ –∏—Å—Ç –Ω–∞—Å—Ç–∞–Ω.</p>
    </section>

    <section id="rss">
      <div class="rss-toolbar">
        <h2 style="margin:0;">üì∞ –í–µ—Å—Ç–∏ –≤–æ –∂–∏–≤–æ</h2>
        <div>
          <span id="rss-badge" class="badge">–ò–Ω–∏—Ü–∏—ò–∞–ª–∏–∑–∞—Ü–∏—ò–∞‚Ä¶</span>
          <button id="btn-refresh" class="btn" type="button">‚Üª –û—Å–≤–µ–∂–∏</button>
        </div>
      </div>

      <div id="rss-status" style="font-size:0.92em;color:var(--muted);margin-bottom:10px;">
        –°–µ –≤—á–∏—Ç—É–≤–∞–∞—Ç –≤–µ—Å—Ç–∏‚Ä¶
      </div>
      <div id="rss-feed"></div>

      <div style="font-size:0.86em;color:#777;margin-top:14px;">
        –ê–∫–æ —Å—Ç–æ–∏ ‚Äú—Å–µ –≤—á–∏—Ç—É–≤–∞–∞—Ç‚Äù –ø–æ–¥–æ–ª–≥–æ –≤—Ä–µ–º–µ: –Ω–∞—ò—Å–∏–≥—É—Ä–Ω–æ —Ä–µ—à–µ–Ω–∏–µ –µ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏–º–µ –ª–æ–∫–∞–ª–µ–Ω <code>data/news.json</code> (–±–µ–∑ CORS).
      </div>
    </section>

  </div>

  <footer>
    <div style="margin-bottom:10px;">
      <strong style="letter-spacing:0.3px;font-size:1.12em;">üåç Makedon World News</strong>
    </div>

    <div class="footer-links">
      <a href="https://www.facebook.com/share/1CycSPu4qU/" target="_blank" rel="noopener">Facebook</a> ‚Ä¢
      <a href="https://www.instagram.com/makedonworldnews" target="_blank" rel="noopener">Instagram</a> ‚Ä¢
      <a href="https://www.tiktok.com/@makedon.worldnews" target="_blank" rel="noopener">TikTok</a> ‚Ä¢
      <a href="https://x.com/makedonworldnew" target="_blank" rel="noopener">X</a> ‚Ä¢
      <a href="https://youtube.com/@makedonworldnews" target="_blank" rel="noopener">YouTube</a>
    </div>

    <div class="footer-divider"></div>
    <div style="font-size:0.92em;color:#aaa;">¬© 2026 Makedon World News. All rights reserved.</div>
  </footer>

  <script>
    // ====== 1) –ò–∑–≤–æ—Ä–∏ (–º–æ–∂–µ—à –¥–∞ –¥–æ–¥–∞–≤–∞—à —É—à—Ç–µ, –ø–æ —Ä–µ–≥–∏–æ–Ω/–∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç) ======
    const FEEDS = [
      { region: "–ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞", sources: [
        { name: "–ú–ò–ê", url: "https://mia.mk/rss" },
        { name: "Makfax", url: "https://makfax.com.mk/feed/" },
        { name: "NetPress", url: "https://netpress.com.mk/feed/" }
      ]},
      { region: "–ë–∞–ª–∫–∞–Ω", sources: [
        { name: "N1 HR", url: "https://n1info.hr/feed/" }
      ]},
      { region: "–ï–≤—Ä–æ–ø–∞", sources: [
        { name: "BBC Europe", url: "https://feeds.bbci.co.uk/news/world/europe/rss.xml" }
      ]},
      { region: "–ê–∑–∏—ò–∞", sources: [
        { name: "BBC Asia", url: "https://feeds.bbci.co.uk/news/world/asia/rss.xml" }
      ]},
      { region: "–ò–Ω–¥–∏—ò–∞", sources: [
        { name: "BBC India", url: "https://feeds.bbci.co.uk/news/world/asia/india/rss.xml" }
      ]},
      { region: "–ê–º–µ—Ä–∏–∫–∞", sources: [
        { name: "BBC Americas", url: "https://feeds.bbci.co.uk/news/world/us_and_canada/rss.xml" }
      ]},
      { region: "–ê—Ñ—Ä–∏–∫–∞", sources: [
        { name: "BBC Africa", url: "https://feeds.bbci.co.uk/news/world/africa/rss.xml" }
      ]},
      { region: "–û–∫–µ–∞–Ω–∏—ò–∞ (–ê–≤—Å—Ç—Ä–∞–ª–∏—ò–∞ + –ù–æ–≤ –ó–µ–ª–∞–Ω–¥)", sources: [
        { name: "BBC Australia", url: "https://feeds.bbci.co.uk/news/world/australia/rss.xml" }
      ]},
      { region: "–ê–Ω—Ç–∞—Ä–∫—Ç–∏–∫ / –û–∫–µ–∞–Ω–∏ (–æ–ø—à—Ç–æ)", sources: [
        { name: "BBC Science & Environment", url: "https://feeds.bbci.co.uk/news/science_and_environment/rss.xml" }
      ]}
    ];

    // ====== 2) DOM refs ======
    const feedEl   = document.getElementById("rss-feed");
    const statusEl = document.getElementById("rss-status");
    const badgeEl  = document.getElementById("rss-badge");
    const btnRef   = document.getElementById("btn-refresh");

    function esc(s){ return (s||"").replace(/[&<>"']/g, m => ({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;" }[m])); }

    function renderItem(srcName, title, link){
      const div = document.createElement("div");
      div.className = "rss-item";
      div.innerHTML = `<strong>[${esc(srcName)}]</strong> ${esc(title)}<br>
        <a href="${esc(link)}" target="_blank" rel="noopener">–ü—Ä–æ—á–∏—Ç–∞—ò –ø–æ–≤–µ—ú–µ</a>`;
      return div;
    }

    function setBadge(text, ok=false){
      badgeEl.textContent = text;
      badgeEl.style.background = ok ? "#e8f6ee" : "#eee";
      badgeEl.style.color = ok ? "#146c2e" : "#333";
      badgeEl.style.border = ok ? "1px solid #bfe8cc" : "1px solid transparent";
    }

    // ====== 3) –ù–∞—ò—Å—Ç–∞–±–∏–ª–Ω–æ: –ª–æ–∫–∞–ª–µ–Ω JSON (–∞–∫–æ –ø–æ—Å—Ç–æ–∏) ======
    async function loadFromLocalJson(){
      // –∞–∫–æ –ø–æ–¥–æ—Ü–Ω–∞ –¥–æ–¥–∞–¥–µ–º–µ GitHub Action, —ú–µ –∏–º–∞—à data/news.json
      const url = "data/news.json?ts=" + Date.now();
      const res = await fetch(url, { cache:"no-store" });
      if(!res.ok) throw new Error("No local JSON");
      const data = await res.json(); // –æ—á–µ–∫—É–≤–∞–º–µ { updatedAt, groups:[{region, items:[{source,title,link}]}] }
      return data;
    }

    // ====== 4) –§–æ–ª–±–µ–∫: proxy —á–∏—Ç–∞—ö–µ RSS (–º–æ–∂–µ –¥–∞ –±–∏–¥–µ –±–ª–æ–∫–∏—Ä–∞–Ω–æ/—Å–ø–æ—Ä–æ) ======
    const proxies = [
      (u) => "https://api.allorigins.win/raw?url=" + encodeURIComponent(u),
      (u) => "https://corsproxy.io/?" + encodeURIComponent(u)
    ];

    async function fetchTextWithFallback(url){
      let lastErr = null;

      // timeout –∑–∞ –¥–∞ –Ω–µ ‚Äú–≤–∏—Å–∏‚Äù
      for(const px of proxies){
        const controller = new AbortController();
        const t = setTimeout(() => controller.abort(), 9000);

        try{
          const res = await fetch(px(url), { cache:"no-store", signal: controller.signal });
          clearTimeout(t);
          if(!res.ok) throw new Error("HTTP " + res.status);
          return await res.text();
        }catch(e){
          clearTimeout(t);
          lastErr = e;
        }
      }
      throw lastErr || new Error("Fetch failed");
    }

    function parseRssOrAtom(xmlText){
      const doc = new DOMParser().parseFromString(xmlText, "text/xml");
      const rssItems = Array.from(doc.querySelectorAll("item"));
      if(rssItems.length){
        return rssItems.slice(0,5).map(it => ({
          title: (it.querySelector("title")?.textContent || "").trim(),
          link:  (it.querySelector("link")?.textContent  || "").trim()
        })).filter(x => x.title && x.link);
      }

      // ATOM fallback
      const entries = Array.from(doc.querySelectorAll("entry"));
      if(entries.length){
        return entries.slice(0,5).map(en => {
          const title = (en.querySelector("title")?.textContent || "").trim();
          const linkEl = en.querySelector('link[rel="alternate"]') || en.querySelector("link");
          const link = (linkEl?.getAttribute("href") || "").trim();
          return { title, link };
        }).filter(x => x.title && x.link);
      }

      return [];
    }

    async function loadViaProxy(){
      const groupsOut = [];

      for(const group of FEEDS){
        const itemsOut = [];
        for(const src of group.sources){
          try{
            const xml = await fetchTextWithFallback(src.url);
            const items = parseRssOrAtom(xml);
            items.forEach(it => itemsOut.push({ source: src.name, title: it.title, link: it.link }));
          }catch(e){
            // —Ç–∏–≤–∫–æ: —Å–∞–º–æ —ú–µ –ø–æ–∫–∞–∂–µ–º–µ –¥–µ–∫–∞ –Ω–µ–∫–æ—ò –∏–∑–≤–æ—Ä –Ω–µ —Å–µ –≤—á–∏—Ç–∞–ª
            itemsOut.push({ source: src.name, title: "‚ö†Ô∏è –ù–µ –º–æ–∂–µ –¥–∞ —Å–µ –≤—á–∏—Ç–∞ (proxy/CORS)", link: src.url });
          }
        }
        groupsOut.push({ region: group.region, items: itemsOut });
      }

      return { updatedAt: new Date().toISOString(), groups: groupsOut };
    }

    function renderData(data){
      feedEl.innerHTML = "";

      let total = 0;
      for(const g of (data.groups || [])){
        const h3 = document.createElement("h3");
        h3.textContent = "üåç " + g.region;
        feedEl.appendChild(h3);

        const items = (g.items || []).slice(0, 20); // –ø–æ —Ä–µ–≥–∏–æ–Ω –º–∞–∫—Å–∏–º—É–º 20, –∑–∞ –¥–∞ –Ω–µ –±–∏–¥–µ —Ç–µ—à–∫–æ
        items.forEach(it => {
          feedEl.appendChild(renderItem(it.source, it.title, it.link));
          total++;
        });
      }

      const ts = data.updatedAt ? new Date(data.updatedAt) : new Date();
      statusEl.textContent = total
        ? `–ê–∂—É—Ä–∏—Ä–∞–Ω–æ: ${ts.toLocaleString()} ‚Ä¢ –í–∫—É–ø–Ω–æ —Å—Ç–∞–≤–∫–∏: ${total}`
        : "–ù–µ–º–∞ –≤—á–∏—Ç–∞–Ω–∏ –≤–µ—Å—Ç–∏.";
      setBadge(total ? "LIVE" : "–ù–µ–º–∞ –≤–µ—Å—Ç–∏", !!total);
    }

    async function loadFeeds(){
      setBadge("–í—á–∏—Ç—É–≤–∞—ö–µ‚Ä¶");
      statusEl.textContent = "–°–µ –≤—á–∏—Ç—É–≤–∞–∞—Ç –≤–µ—Å—Ç–∏‚Ä¶";
      feedEl.innerHTML = "";

      // 1) –ø—Ä–æ–±–∞—ò –ª–æ–∫–∞–ª–µ–Ω JSON
      try{
        const local = await loadFromLocalJson();
        renderData(local);
        return;
      }catch(_){ /* continue */ }

      // 2) —Ñ–æ–ª–±–µ–∫ –ø—Ä–µ–∫—É proxy
      try{
        const data = await loadViaProxy();
        renderData(data);
      }catch(e){
        statusEl.textContent = "–ù–µ—É—Å–ø–µ—à–Ω–æ –≤—á–∏—Ç—É–≤–∞—ö–µ (–ª–æ–∫–∞–ª–µ–Ω JSON –Ω–µ–º–∞, proxy –µ –±–ª–æ–∫–∏—Ä–∞–Ω).";
        setBadge("–ü—Ä–æ–±–ª–µ–º", false);
      }
    }

    // —Å—Ç–∞—Ä—Ç
    document.addEventListener("DOMContentLoaded", () => {
      btnRef.addEventListener("click", loadFeeds);
      loadFeeds();
      // –æ—Å–≤–µ–∂—É–≤–∞—ö–µ –Ω–∞ 10 –º–∏–Ω—É—Ç–∏
      setInterval(loadFeeds, 10 * 60 * 1000);
    });
  </script>
</body>
</html>
