<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Makedon World News</title>

  <style>
    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Ubuntu,sans-serif;
      line-height:1.6;
      background:#f5f5f5;
      color:#222;
    }

    header{
      background:#111;
      color:#fff;
      text-align:center;
      padding:22px 16px 16px;
    }

    header img{
      max-width:220px;
      width:100%;
      height:auto;
      border-radius:12px;
    }

    .site-title{
      font-size:2.7em;
      font-weight:750;
      margin:12px 0 6px;
      letter-spacing:0.2px;
    }

    .site-tagline{
      font-size:1.05em;
      color:#ddd;
      margin:0;
    }

    .container{
      max-width:900px;
      margin:0 auto;
      padding:0 16px;
    }

    .header-line{
      border:0;
      height:1px;
      background:rgba(255,255,255,0.35);
      width:100%;
      margin:12px 0 14px;
    }

    section{
      background:#fff;
      border-radius:10px;
      padding:22px;
      margin:18px auto;
      box-shadow:0 1px 0 rgba(0,0,0,0.04);
    }

    .trust{
      background:#111;
      color:#fff;
    }
    .trust hr{ opacity:0.25; }

    h2{ margin:0 0 12px; }
    h3{ margin:18px 0 10px; }

    a{ color:#0b5ed7; text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .rss-toolbar{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin:10px 0 12px;
    }

    .btn{
      appearance:none;
      border:1px solid #ddd;
      background:#fff;
      padding:8px 12px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
    }
    .btn:hover{ background:#f3f3f3; }

    .status{
      font-size:0.9em;
      color:#666;
    }

    .rss-item{ margin:10px 0 14px; }
    .rss-item strong{ display:inline-block; margin-bottom:2px; }
    .rss-meta{ font-size:0.85em; color:#777; margin-top:2px; }

    .pill{
      display:inline-block;
      font-size:0.78em;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(0,0,0,0.12);
      margin-left:8px;
      color:#444;
      background:#fafafa;
    }

    .warn{
      color:#a00;
      font-size:0.9em;
      margin-top:8px;
    }

    footer{
      background:#111;
      color:#eee;
      padding:32px 16px;
      margin-top:40px;
      text-align:center;
      font-size:0.95em;
    }

    .footer-links a{
      color:#eee;
      text-decoration:none;
      margin:0 10px;
      display:inline-block;
      padding:6px 0;
    }
    .footer-links a:hover{ text-decoration:underline; }

    .footer-divider{
      height:1px;
      background:#2a2a2a;
      margin:18px auto;
      max-width:520px;
    }

    @media (max-width:600px){
      .site-title{ font-size:2.15em; }
      header img{ max-width:180px; }
    }
  </style>
</head>

<body>
  <header>
    <img src="hero.jpg" alt="Makedon World News ‚Äì –Ω–µ–∑–∞–≤–∏—Å–µ–Ω –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Å—Ç–∏" />
    <div class="site-title">üåç Makedon World News</div>
    <hr class="header-line">
    <p class="site-tagline">–ù–µ–∑–∞–≤–∏—Å–µ–Ω –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Å—Ç–∏ –æ–¥ –ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞, –ë–∞–ª–∫–∞–Ω–æ—Ç, –ï–≤—Ä–æ–ø–∞ –∏ —Å–≤–µ—Ç–æ—Ç.</p>
  </header>

  <div class="container">

    <section id="about">
      <h2>üõ°Ô∏è About / Mission</h2>

      <p>Makedon World News –µ –Ω–µ–∑–∞–≤–∏—Å–µ–Ω –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä –Ω–∞ –≤–µ—Å—Ç–∏ –æ–¥ –†–µ–ø—É–±–ª–∏–∫–∞ –°–µ–≤–µ—Ä–Ω–∞ –ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞,
      –ë–∞–ª–∫–∞–Ω–æ—Ç, –ï–≤—Ä–æ–ø–∞ –∏ —Å–≤–µ—Ç–æ—Ç.</p>

      <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ç–∞ —Å–æ–±–∏—Ä–∞, —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∏—Ä–∞ –∏ –ø—Ä–∏–∫–∞–∂—É–≤–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–¥ –¥–æ–≤–µ—Ä–ª–∏–≤–∏ –º–µ–¥–∏—É–º—Å–∫–∏ –∏–∑–≤–æ—Ä–∏,
      —Å–æ —Ü–µ–ª –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏—Ç–µ –¥–∞ –¥–æ–±–∏—ò–∞—Ç –±—Ä–∑, —ò–∞—Å–µ–Ω –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω –ø—Ä–µ–≥–ª–µ–¥ –Ω–∞ –∞–∫—Ç—É–µ–ª–Ω–∏—Ç–µ –Ω–∞—Å—Ç–∞–Ω–∏.</p>

      <p>Makedon World News –Ω–µ —Å–æ–∑–¥–∞–≤–∞ —Å–æ–ø—Å—Ç–≤–µ–Ω–∏ –≤–µ—Å—Ç–∏ –∏ –Ω–µ –ø—Ä–æ–º–æ–≤–∏—Ä–∞ –ø–æ–ª–∏—Ç–∏—á–∫–∏, –Ω–∞—Ü–∏–æ–Ω–∞–ª–Ω–∏ –∏–ª–∏ –∏–¥–µ–æ–ª–æ—à–∫–∏ –∞–≥–µ–Ω–¥–∏.</p>

      <h3>üéØ –ù–∞—à–∞—Ç–∞ –º–∏—Å–∏—ò–∞</h3>
      <ul>
        <li>–°–ª–æ–±–æ–¥–µ–Ω –∏ –æ—Ç–≤–æ—Ä–µ–Ω –ø—Ä–∏—Å—Ç–∞–ø –¥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</li>
        <li>–ü–æ—Ç—Ç–∏–∫–Ω—É–≤–∞—ö–µ –Ω–∞ –º–µ–¥–∏—É–º—Å–∫–∞ –ø–∏—Å–º–µ–Ω–æ—Å—Ç</li>
        <li>–ü–æ–¥–æ–±—Ä–æ —Ä–∞–∑–±–∏—Ä–∞—ö–µ –Ω–∞ –Ω–∞—Å—Ç–∞–Ω–∏—Ç–µ –ø—Ä–µ–∫—É –ø–æ–≤–µ—ú–µ –∏–∑–≤–æ—Ä–∏</li>
        <li>–ù–∞–º–∞–ª—É–≤–∞—ö–µ –Ω–∞ –≤–ª–∏—ò–∞–Ω–∏–µ—Ç–æ –Ω–∞ –¥–µ–∑–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</li>
      </ul>

      <h3>üåç English Version</h3>
      <p>Makedon World News is an independent news aggregator based in the Republic of North Macedonia,
      covering the Balkans, Europe, and the world.</p>
      <p>We aggregate and link to original sources so users can compare coverage and form informed opinions.</p>
    </section>

    <section id="trust" class="trust">
      <h2>üîê –î–æ–≤–µ—Ä–±–∞ &amp; –¢—Ä–∞–Ω—Å–ø–∞—Ä–µ–Ω—Ç–Ω–æ—Å—Ç</h2>
      <p>Makedon World News –Ω–µ –∫—Ä–µ–∏—Ä–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∞ –Ω–æ–≤–∏–Ω–∞—Ä—Å–∫–∞ —Å–æ–¥—Ä–∂–∏–Ω–∞ ‚Äì –∞–≥—Ä–µ–≥–∏—Ä–∞ –∏ —É–ø–∞—Ç—É–≤–∞ –∫–æ–Ω –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –∏–∑–≤–æ—Ä–∏,
      —Å–æ —ò–∞—Å–Ω–æ –Ω–∞–≤–µ–¥—É–≤–∞—ö–µ –Ω–∞ –∏–∑–≤–æ—Ä–æ—Ç –∑–∞ —Å–µ–∫–æ—ò–∞ –≤–µ—Å—Ç.</p>
      <p>–¶–µ–ª—Ç–∞ –µ —Ç—Ä–∞–Ω—Å–ø–∞—Ä–µ–Ω—Ç–Ω–æ –∏ –Ω–µ–ø—Ä–∏—Å—Ç—Ä–∞—Å–Ω–æ –¥–∞ –ø—Ä–∏–∫–∞–∂–µ–º–µ –ø–æ–≤–µ—ú–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏ –∏–∑–≤–æ—Ä–∏ –∑–∞ –∏—Å—Ç –Ω–∞—Å—Ç–∞–Ω.</p>
    </section>

    <section id="rss">
      <h2>üì∞ –í–µ—Å—Ç–∏ –≤–æ –∂–∏–≤–æ <span class="pill" id="mode-pill">AUTO</span></h2>

      <div class="rss-toolbar">
        <button class="btn" id="refreshBtn">‚Üª –û—Å–≤–µ–∂–∏</button>
        <div class="status" id="rss-status">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞‚Ä¶</div>
      </div>

      <div id="rss-feed"></div>
      <div class="warn" id="rss-warn" style="display:none;"></div>
    </section>

  </div>

  <footer>
    <div style="margin-bottom:10px;">
      <strong style="letter-spacing:0.3px;font-size:1.1em;">üåç Makedon World News</strong>
    </div>

    <div class="footer-links">
      <a href="https://www.facebook.com/share/1CycSPu4qU/" target="_blank" rel="noopener">Facebook</a> ‚Ä¢
      <a href="https://www.instagram.com/makedonworldnews" target="_blank" rel="noopener">Instagram</a> ‚Ä¢
      <a href="https://www.tiktok.com/@makedon.worldnews" target="_blank" rel="noopener">TikTok</a> ‚Ä¢
      <a href="https://x.com/makedonworldnew" target="_blank" rel="noopener">X</a> ‚Ä¢
      <a href="https://youtube.com/@makedonworldnews" target="_blank" rel="noopener">YouTube</a>
    </div>

    <div class="footer-divider"></div>
    <div style="font-size:0.95em;color:#aaa;">¬© 2026 Makedon World News. All rights reserved.</div>
  </footer>

  <script>
  (function(){
    const FEEDS = [
      { region: "–ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞", sources: [
        { name: "–ú–ò–ê", url: "https://mia.mk/rss" },
        { name: "Makfax", url: "https://makfax.com.mk/feed/" },
        { name: "NetPress", url: "https://netpress.com.mk/feed/" }
      ]},
      { region: "–°–≤–µ—Ç", sources: [
        { name: "BBC", url: "https://feeds.bbci.co.uk/news/world/rss.xml" },
        { name: "Al Jazeera", url: "https://www.aljazeera.com/xml/rss/all.xml" }
      ]}
    ];

    const feedEl = document.getElementById("rss-feed");
    const statusEl = document.getElementById("rss-status");
    const warnEl = document.getElementById("rss-warn");
    const modePill = document.getElementById("mode-pill");
    const refreshBtn = document.getElementById("refreshBtn");

    if (!feedEl || !statusEl) return;

    const proxies = [
      (u) => "https://api.allorigins.win/raw?url=" + encodeURIComponent(u),
      (u) => "https://corsproxy.io/?" + encodeURIComponent(u),
    ];

    function setMode(text){ modePill.textContent = text; }

    function escapeHtml(s){
      return String(s || "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;");
    }

    function renderGroupTitle(title){
      const h3 = document.createElement("h3");
      h3.textContent = "üåç " + title;
      h3.style.marginTop = "18px";
      return h3;
    }

    function renderItem(srcName, title, link, timeText){
      const div = document.createElement("div");
      div.className = "rss-item";
      div.innerHTML =
        `<strong>[${escapeHtml(srcName)}]</strong> ${escapeHtml(title)}<br>` +
        `<a href="${escapeHtml(link)}" target="_blank" rel="noopener">–ü—Ä–æ—á–∏—Ç–∞—ò –ø–æ–≤–µ—ú–µ</a>` +
        (timeText ? `<div class="rss-meta">${escapeHtml(timeText)}</div>` : "");
      return div;
    }

    function showWarn(msg){
      warnEl.style.display = "block";
      warnEl.textContent = msg;
    }
    function hideWarn(){
      warnEl.style.display = "none";
      warnEl.textContent = "";
    }

    async function tryLocalJson(){
      // –ù–∞—ò—Å—Ç–∞–±–∏–ª–Ω–æ: –∏—Å—Ç –¥–æ–º–µ–Ω => –Ω–µ–º–∞ CORS.
      // –ê–∫–æ (—Å–µ—É—à—Ç–µ) –Ω–µ–º–∞ data/news.json, —ú–µ —Ñ—Ä–ª–∏ 404 –∏ —ú–µ –ø–∞–¥–Ω–µ–º–µ –Ω–∞ live RSS.
      const url = "data/news.json?ts=" + Date.now();
      const res = await fetch(url, { cache:"no-store" });
      if (!res.ok) throw new Error("local json HTTP " + res.status);
      const data = await res.json();

      // –û—á–µ–∫—É–≤–∞–Ω —Ñ–æ—Ä–º–∞—Ç:
      // { generatedAt: "...", items: [ {region, source, title, link, published} ... ] }
      if (!data || !Array.isArray(data.items)) throw new Error("bad json format");

      return data;
    }

    async function fetchTextWithFallback(url){
      let lastErr = null;
      for (const px of proxies) {
        try {
          const res = await fetch(px(url), { cache:"no-store" });
          if (!res.ok) throw new Error("HTTP " + res.status);
          return await res.text();
        } catch (e) {
          lastErr = e;
        }
      }
      throw lastErr || new Error("Fetch failed");
    }

    function parseRssItems(xmlText, limit=5){
      const doc = new DOMParser().parseFromString(xmlText, "text/xml");
      const items = Array.from(doc.querySelectorAll("item")).slice(0, limit);

      return items.map(it => ({
        title: (it.querySelector("title")?.textContent || "").trim(),
        link: (it.querySelector("link")?.textContent || "").trim(),
        published: (it.querySelector("pubDate")?.textContent || "").trim()
      })).filter(x => x.title && x.link);
    }

    async function fetchRss(url){
      const xmlText = await fetchTextWithFallback(url);
      return parseRssItems(xmlText, 5);
    }

    function renderFromLocalJson(data){
      feedEl.innerHTML = "";
      hideWarn();

      const byRegion = new Map();
      for (const it of data.items) {
        const r = it.region || "–°–≤–µ—Ç";
        if (!byRegion.has(r)) byRegion.set(r, []);
        byRegion.get(r).push(it);
      }

      let total = 0;
      for (const [region, items] of byRegion.entries()) {
        feedEl.appendChild(renderGroupTitle(region));
        items.slice(0, 25).forEach(it => {
          feedEl.appendChild(renderItem(it.source || "Source", it.title, it.link, it.published || ""));
          total++;
        });
      }

      statusEl.textContent = total ? "–ê–∂—É—Ä–∏—Ä–∞–Ω–æ (–ª–æ–∫–∞–ª–µ–Ω news.json)." : "–ù–µ–º–∞ –≤–µ—Å—Ç–∏ –≤–æ –ª–æ–∫–∞–ª–Ω–∏–æ—Ç news.json.";
      setMode("LOCAL");
    }

    async function renderLiveRss(){
      feedEl.innerHTML = "";
      hideWarn();

      let total = 0;
      for (const group of FEEDS) {
        feedEl.appendChild(renderGroupTitle(group.region));

        for (const src of group.sources) {
          try {
            const items = await fetchRss(src.url);
            items.slice(0, 4).forEach(item => {
              feedEl.appendChild(renderItem(src.name, item.title, item.link, item.published));
              total++;
            });
          } catch (e) {
            const err = document.createElement("div");
            err.className = "warn";
            err.textContent = `‚ö†Ô∏è –ù–µ –º–æ–∂–µ –¥–∞ —Å–µ –≤—á–∏—Ç–∞ ${src.name} (proxy/CORS).`;
            feedEl.appendChild(err);
          }
        }
      }

      statusEl.textContent = total ? "–ê–∂—É—Ä–∏—Ä–∞–Ω–æ (live RSS)." : "–ù–µ–º–∞ –≤—á–∏—Ç–∞–Ω–∏ –≤–µ—Å—Ç–∏ (proxy/–∏–∑–≤–æ—Ä–∏).";
      setMode("LIVE");
      if (!total) {
        showWarn("–°–æ–≤–µ—Ç: –ù–∞—ò—Å—Ç–∞–±–∏–ª–Ω–æ –µ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏–º–µ –ª–æ–∫–∞–ª–µ–Ω data/news.json –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω –∞–≤—Ç–æ–º–∞—Ç—Å–∫–∏ (GitHub Actions). –ê–∫–æ —Å–∞–∫–∞—à, –≤–æ —Å–ª–µ–¥–µ–Ω —á–µ–∫–æ—Ä —ú–µ –≥–æ –≤–∫–ª—É—á–∏–º–µ.");
      }
    }

    async function loadAll(){
      statusEl.textContent = "–í—á–∏—Ç—É–≤–∞—ö–µ‚Ä¶";
      setMode("AUTO");
      hideWarn();

      // 1) –ø—Ä–æ–±–∞—ò –ª–æ–∫–∞–ª–µ–Ω JSON
      try {
        const data = await tryLocalJson();
        renderFromLocalJson(data);
        return;
      } catch (e) {
        // –ø–∞–¥–Ω–∏ –Ω–∞ live RSS
      }

      // 2) live RSS best-effort
      await renderLiveRss();
    }

    refreshBtn.addEventListener("click", loadAll);

    // —Å—Ç–∞—Ä—Ç
    loadAll();

    // —Å—Ç–∞–±–∏–ª–Ω–æ –æ—Å–≤–µ–∂—É–≤–∞—ö–µ (–Ω–∞ 10 –º–∏–Ω—É—Ç–∏) ‚Äì –±–µ–∑ –¥–∞ —ò–∞ ‚Äú—É–¥–∞–≤–∏–º–µ‚Äù —Å—Ç—Ä–∞–Ω–∞—Ç–∞ –∏ –ø—Ä–æ–∫—Å–∏—ò–∞—Ç–∞
    setInterval(loadAll, 10 * 60 * 1000);
  })();
  </script>
</body>
</html>
